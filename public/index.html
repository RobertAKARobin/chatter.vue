<!DOCTYPE html>
<html>
	<head>
		<title>Chatter.vue</title>
		<script src="./vendor/vue/dist/vue.js"></script>
		<script src="./vendor/vuefire/dist/vuefire.js"></script>
		<script src="./vendor/vue-router/dist/vue-router.js"></script>
		<script src="./vendor/firebase/firebase.js"></script>
		<script src="./js/app.js"></script>
		<link rel="stylesheet" href="./css/style.css" />
	</head>
	<body>
		<div id="app">
			<h1>
				<router-link :to="{name: 'convoHeaderList'}">
					&num;&num;&num;&num;&num;
				</router-link>
			</h1>

			<div class="wrap">
				<router-view></router-view>
				<fb-console></fb-console>
			</div>
		</div>

		<template id="convoHeaderList">
			<div class="postlist">
				<ul>
					<li>
						<convo-header-form shown-init="true"></convo-header-form>
					</li>
					<li v-for="convoHeader in all">
						<convo-header :db="convoHeader"></convo-headeR>
					</li>
				</ul>
			</div>
		</template>

		<template id="convoHeader">
			<h3>
				<router-link :to="route">{{db.title}}</router-link>
				({{db.count || 0}})
			</h3>
		</template>

		<template id="convoHeaderForm">
			<div>
				<div v-if="shown">
					<input v-model="db.title" />
					<div class="controls">
						<p class="error">{{error}}</p>
						<div v-if="fbid">
							<a @click="hide()">Cancel</a>
							<a @click="destroy()">Delete</a>
							<a v-if="isSubmittable" @click="save()">Save</a>
							<a v-if="!isSubmittable" class="disabled">Save</a>
						</div>
						<div v-else>
							<a v-if="isSubmittable" @click="create()">Add</a>
							<a v-if="!isSubmittable" class="disabled">Add</a>
						</div>
					</div>
				</div>
				<div v-else class="controls">
					<a @click="show()">Edit</a>
				</div>
			</div>
		</template>

		<template id="convo">
			<div>
				<div v-if="header.title">
					<convo-header :db="header"></convo-header>
					<convo-header-form :fbid="header['.key']"></convo-header-form>
					<ul>
						<li v-for="(post, index) in all">
							{{index + 1}}: <post :db="post"></post>
						</li>
						<li>
							<post-form :convoid="header['.key']"></post-form>
						</li>
					</ul>
				</div>
				<div v-else>
					<h2>This doesn't exist.</h2>
				</div>
			</div>
		</template>

		<template id="post">
			<span>
				{{db.content}}
			</span>
		</template>

		<template id="postForm">
			<div>
				<input v-model="db.content" @keydown.enter="create()" />
				<p class="error">{{error}}</p>
			</div>
		</template>

		<template id="fbConsole">
			<div class="console">
				<textarea disabled>{{all}}</textarea>
			</div>
		</template>

	</body>
</html>
